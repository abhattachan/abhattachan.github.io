import { createRequire as _createRequire } from 'node:module';
const require = _createRequire(import.meta.url);
import{a as h,b as C,c as D,d as j,f as N}from"./chunk-MKQBXJBE.js";import"./chunk-Q6WPLZZC.js";import{b as P}from"./chunk-XBIKRRQN.js";import"./chunk-6TDWVLRD.js";import{a as I}from"./chunk-Z6MBXKB5.js";import{a as y,b as u,c as m,d as w}from"./chunk-34HYWOQN.js";import"./chunk-CCZ55TG3.js";import{a as f}from"./chunk-ULZRRJS5.js";import"./chunk-XOWZQRGH.js";import"./chunk-QC5Y7QKP.js";import"./chunk-QKI65SFV.js";import"./chunk-SHTCM5ZT.js";import"./chunk-SPXP6KD4.js";import"./chunk-CNRVJIPG.js";import"./chunk-SYHT5LTW.js";import"./chunk-K656WQZA.js";import"./chunk-TVMTOQUC.js";import"./chunk-F67LDVCV.js";import"./chunk-ZBJRW65P.js";import"./chunk-J3IJS26Z.js";import"./chunk-CJ3JTOGS.js";import"./chunk-NUQ6G6J3.js";import{b as g,c as d}from"./chunk-3VDYJ2A2.js";import"./chunk-NWTFQJ5S.js";import{c,e as s}from"./chunk-CU4HXYD6.js";import{i as t}from"./chunk-UO4ZAUJK.js";t();t();import{cwd as E}from"node:process";t();async function x(e,o,n,a,r){let i;try{e?(i=r.logDependencyInstalling(e,null),await j(e,null,o.projectFolder,a)):(i=r.logAllDependenciesInstalling(),await N(o.projectFolder,a)),await D(o.projectFolder,{authState:n})}finally{i&&i()}}t();import{unlink as k}from"node:fs/promises";t();async function M(e){let o=await g(m(e));try{return u.parse(o)}catch(n){throw new c({code:s.InvalidVeloConfigJson({configFilename:y,cause:n})})}}var A=async(e,o)=>{let n=m(e);if(await d(n))try{o.logMigratingToAnyNpm();let a=await M(e);await C(e,a),await k(n),o.logMigrationToAnyNpmCompletedSuccessfully()}catch(a){throw o.logMigrationToAnyNpmFailed(a),a}};async function T({biLogger:e,errorReporter:o},n,a){let r=await w(E()),i=await I({metaSiteId:r.metaSiteId,biLogger:e,errorReporter:o}),F=f(),p=P({t:F}),S=a?.trim()??null,l;n.yarn?l="yarn":n.npm?l="npm":l=await h(r.projectFolder),await A(r.projectFolder,p),await x(S,r,i,l,p)}export{T as install};
//# sourceMappingURL=install-ZS3JQW7R.js.map